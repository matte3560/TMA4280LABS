CC=gcc
FC=gfortran
CFLAGS=-std=c99 -O3 -MMD
LDFLAGS=-lm

# Directories
DIR_COMMON=../common
DIR_TEST=../test
DIR_SERIAL=../serial

# Include directories
VPATH=$(DIR_COMMON) $(DIR_TEST) $(DIR_SERIAL)
INCLUDE=-I$(DIR_COMMON) -I$(DIR_TEST) -I$(DIR_SERIAL)
CFLAGS+=$(INCLUDE)
FFLAGS+=$(INCLUDE)

# Object files
COMMON=common_poisson.o fst.o
COMMON_TEST=common_test.o
SERIAL_COMMON=serial_poisson.o $(COMMON)


# Targets
all: serial

utest: serial_utest

serial: serial.o $(SERIAL_COMMON)

serial_utest: serial_utest.o $(SERIAL_COMMON) $(COMMON_TEST)


# Include dependencies autogenerated by GCC (headers, etc.)
-include *.d

.PHONY: clean

clean:
	$(RM) *.o *.d serial serial_utest
